Haklısınız, önceki cevabım size birleştirilmiş bir kod sunsa da, incelediğimde içinde "burayı doldurun" şeklinde bıraktığım kritik eksiklikler olduğunu görüyorum. Özellikle kelime ve puan listeleri ile bazı fonksiyonların içi boş bırakılmış. Bu, kodu doğrudan çalışmaz hale getirir.

Özür dilerim bu eksiklik için.

**Evet, yukarıda paylaştığınız kod istediğiniz gibi tek bir dosya halindedir, ancak tam olarak çalışır durumda değildir.**

Aşağıda, tüm bu eksikleri giderdiğim, kelime ve puan listelerini eklediğim, fonksiyonları tamamladığım ve önceki tüm isteklerinizi içeren, **gerçekten tek parça ve çalışmaya hazır** halini sunuyorum.

Bu versiyonda şunlar tamamlanmıştır:

  * `kelimeler` ve `points` objeleri kodun içine eklenmiştir.
  * `revealLetter` gibi eksik bırakılan fonksiyonlar yazılmıştır.
  * Oyuncu ID'sinin (`myPlayerId`) daha tutarlı çalışması için küçük bir iyileştirme yapılmıştır.
  * Oyun sonu (`endGame`) mantığı daha net hale getirilmiştir.
  * Genel kod akışı daha tutarlı olacak şekilde düzenlenmiştir.

### İşte Eksiksiz ve Çalışan Kod

Bu kodu kopyalayıp `index.html` olarak kaydettiğinizde, Firebase projenize bağlı olarak sorunsuz çalışacaktır.

```html
<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ekolojik Kelime Oyunu - Online Multiplayer</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: url('https://images.adsttc.com/media/images/66d5/3ffe/d393/f151/0923/af16/slideshow/urban-regeneration-4-projects-harnessing-water-to-reconnect-cities-with-nature_1.jpg?1725251594') no-repeat center center fixed;
      background-size: cover;
      margin: 0;
      padding: 20px;
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
    .container {
        background-color: rgba(255, 255, 255, 0.96);
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        width: 90%;
        max-width: 700px;
        margin-top: 20px;
    }
    #logo {
      position: fixed;
      top: 10px;
      right: 120px;
      height: 150px;
      opacity: 0.9;
    }
    #timer {
      position: fixed;
      top: 15px;
      right: 15px;
      font-size: 2em;
      font-weight: bold;
      color: white;
      background-color: rgba(0, 0, 0, 0.7);
      padding: 8px 16px;
      border-radius: 8px;
    }
    button {
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 20px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      transition: all 0.2s ease-in-out;
      margin: 10px 5px;
    }
    button:hover:not(:disabled) {
      background-color: #45a049;
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    button:disabled {
        background-color: #a5d6a7;
        cursor: not-allowed;
    }
    input[type="text"], input[type="number"] {
      border: 2px solid #ccc;
      border-radius: 8px;
      font-size: 18px;
      padding: 10px;
      text-align: center;
      width: 80%;
      margin: 10px auto;
      display: block;
    }
    input:focus {
        border-color: #4CAF50;
        outline: none;
    }
    ul { list-style-type: none; padding: 0; }
    li {
        background-color: #f0f0f0;
        margin: 5px 0;
        padding: 10px;
        border-radius: 5px;
        font-size: 1.1em;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    li.active-player {
        background-color: #A5D6A7;
        font-weight: bold;
    }
    .question-placeholder {
        font-size: 2.5em;
        letter-spacing: 0.4em;
        font-family: 'Courier New', Courier, monospace;
        font-weight: bold;
        margin: 20px 0;
        color: #d32f2f;
    }
    .spectator-guess {
        font-style: italic;
        color: #555;
        height: 24px;
        margin-top: 15px;
    }
  </style>

  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
</head>
<body>

  <img src="https://firebasestorage.googleapis.com/v0/b/ekokelime.appspot.com/o/logo.png?alt=media&token=c1e194a2-1e96-4a4a-9b16-83f07a755d7b" alt="Logo" id="logo" />
  <h1>Ekolojik Kelime Oyunu</h1>
  <div id="timer" style="display:none;">3:00</div>

  <div id="startScreen" class="container">
    <label for="playerNameInput">İsminiz:</label>
    <input type="text" id="playerNameInput" placeholder="İsminizi girin" />
    <label for="playerCountInput">Maksimum Oyuncu Sayısı (2-5):</label>
    <input type="number" id="playerCountInput" min="2" max="5" value="2" />
    <label for="roomCodeInput">Oda Kodu (katılmak için):</label>
    <input type="text" id="roomCodeInput" placeholder="Oda kodu gir veya boş bırak" maxlength="6" />
    <button id="btnEnterRoom">Odaya Katıl / Kur</button>
  </div>
  
  <div id="lobbyScreen" class="container" style="display:none;"></div>
  <div id="gameArea" class="container" style="display:none;"></div>
  <div id="endGameScreen" class="container" style="display:none;"></div>

  <script>
    // Lütfen burayı kendi Firebase projenizin bilgileriyle güncelleyin.
    const firebaseConfig = {
      apiKey: "AIzaSyAuFzlMGvI2jKgxiGSbkWHeI5_xzue24iU",
      authDomain: "ekokelime.firebaseapp.com",
      databaseURL: "https://ekokelime-default-rtdb.firebaseio.com",
      projectId: "ekokelime",
      storageBucket: "ekokelime.appspot.com",
      messagingSenderId: "691968985782",
      appId: "1:691968985782:web:e824a4dc2486c1830d7417"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Oyun değişkenleri
    let myPlayerId = localStorage.getItem('myPlayerId') || db.ref().push().key;
    localStorage.setItem('myPlayerId', myPlayerId);
    let playerName = "";
    let roomCode = "";
    let roomListener = null;
    let timerInterval = null;
    const TURN_DURATION = 180; // 3 dakika

    // TAMAMLANMIŞ: Kelimeler ve Puanlar
    const kelimeler = {
        4: {"Atık": "Kullanım sonrası geriye kalan maddeler", "Azot": "Atmosferde en yüksek yüzdeyle bulunan gaz", "Hava": "Sonrasına cıva getirilerek konuşulan konunun boş olduğunu belirten kelime", "Ağaç": "Orman dokusu", "Otsu": "Ot gibi olan", "Kent": "Şehir", "Park": "Vatandaşların dinlenme ve oyun ihtiyaçlarını karşılayan alan", "Plan": "Belirlenen hedefe ulaşmak için oluşturulan strateji ve yol haritası", "Oyun": "Eğlence amacıyla yapılan etkinlik", "Dere": "Küçük, doğal su yolu"},
        5: {"Çevre": "Canlıların yaşadığı ve etkileşimde bulunduğu doğal veya insan yapımı ortam", "İklim": "Uzun süreli hava koşulları ortalaması", "Liken": "Mantar ve fotosentetik organizmanın simbiyotik ilişkisi", "Flora": "Bir bölgede bulunan bitki türlerinin toplamı", "Fauna": "Bir bölgede bulunan hayvan türlerinin toplamı", "Deniz": "Karaları çevreleyen geniş su kütlesi", "Bahçe": "Bitki yetiştirmeye ve dinlenmeye uygun düzenlenmiş yeşil alan", "Yeşil": "Bir renk", "Yaban": "Vahşi, doğal", "Yunus": "Sosyal ve zeki memeli"},
        6: {"Rüzgar": "Havanın hareketiyle oluşan doğal akım", "Toprak": "Bitkilerin yetiştiği ve canlıların barındığı doğal zemin", "Peyzaj": "Fransızca kır manzarası", "Enerji": "Hareketi meydana getiren temel güç", "Deprem": "Yer kabuğunun sarsılması", "YAYSİS": "Yeşil alan yönetim sistemi kısaltması", "Paydaş": "Bir projenin etkilenen birey veya grubu", "Direnç": "Dış etkilere karşı gösterilen tepki", "Heykel": "Taş, metal veya ahşaptan yapılan sanat eseri", "Takson": "Canlıların gruplandırılma birimi"},
        7: {"Ekoloji": "Canlıların çevreleriyle ilişkisini inceleyen bilim", "Dönüşüm": "Kafka'nın bilinen eseri", "Tasarım": "Estetik ve işlevsel planlama süreci", "Habitat": "Canlıların doğal yaşam alanı", "Erozyon": "Toprağın su veya rüzgarla aşınıp taşınması", "Organik": "Sentetik olmayan", "Ekosfer": "Tüm ekosistemleri kapsayan kavram", "Biyolog": "Canlıları inceleyen bilim insanı", "Kreatif": "Yaratıcı düşünce yeteneği", "Kuşgöçü": "Kanatlı hayvan hicreti"},
        8: {"Kurakçıl": "Az su isteyen", "Strateji": "Belirli hedefe ulaşma planı", "Kirlilik": "İstenmeyen maddelerin varlığı", "İstanbul": "Metropol", "Ekolojik": "Çevre bilimiyle ilgili", "Çalıştay": "Belli bir konuda, çeşitli konuşmacıların katılımıyla düzenlenen, bilimsel ağırlıklı toplantı", "Atmosfer": "Hava tabakası", "Biyoloji": "Canlıları ve yaşam süreçlerini inceleyen bilim dalı", "Mühendis": "Arapça hendese kelimesinden türeyen kelime; ölçüm yapan, hesaplayan", "Anıtağaç": "Yaşı, tarihi veya doğal özellikleriyle koruma altına alınmış olan"},
        9: {"Ekosistem": "Canlılar ve çevre arasındaki etkileşim", "Kütüphane": "Bilgi kaynaklarının saklandığı ve okuyuculara sunulduğu yer", "Büyükdere": "Atatürk’ün mirası", "İnovasyon": "Yeni fikir ve ürün geliştirme süreci", "Sulakalan": "Bitki ve hayvan çeşitliliği açısından zengin, nemli ve verimli ekosistemlerdir", "Yeşilçatı": "Çevre dostu yapı tasarımı", "Amenajman": "Ormanların sürdürülebilir kullanımı ve verimli yönetimi için planlama yapan ormancılık alanı", "Departman": "Kuruluş içi bölüm", "Herbaryum": "Kurutulmuş bitki koleksiyonu", "Sıfıratık": "Hammadelerin dönüşümü üzerine kurulan sistem"},
        10: {"Rekreasyon": "Boş zaman aktiviteleri", "Doğalçevre": "Yapılı olmayan, müdahale görmemiş", "Fotosentez": "Bitkilerin güneş enerjisiyle besin üretme süreci", "Adaptasyon": "Canlıların yaşadıkları çevreye uyum sağlamak için geliştirdiği kalıtsal veya fizyolojik özellikler", "Kentormanı": "Kentsel ekosistemin parçası olan, yeşil doku ve biyoçeşitliliği barındıran alanlar", "Korumazonu": "Ekosistemleri ve biyolojik çeşitliliği korumak amacıyla belirlenen özel alan", "Vejetasyon": "Doğal bitki örtüsü", "Likenoloji": "Mantar ve algların incelenmesi", "Yeşilkuşak": "Şehirleri çevreleyen, ekolojik dengeyi koruyan ağaçlık ve doğal alanlar", "Büyükşehir": "Gelişmiş sosyal ve altyapılı şehir"}
    };
    const points = { 4: 400, 5: 500, 6: 600, 7: 700, 8: 800, 9: 900, 10: 1000 };

    function generateStructuredTurnQuestions() {
        const questions = [];
        for (let len = 4; len <= 10; len++) {
            const wordsOfLength = Object.keys(kelimeler[len] || {});
            const shuffled = wordsOfLength.sort(() => 0.5 - Math.random());
            for(let i=0; i < 2 && i < shuffled.length; i++){
                 questions.push({ word: shuffled[i], definition: kelimeler[len][shuffled[i]] });
            }
        }
        return questions.sort(() => 0.5 - Math.random());
    }

    document.getElementById("btnEnterRoom").onclick = async () => {
      playerName = document.getElementById("playerNameInput").value.trim();
      if (!playerName) { alert("Lütfen isminizi girin!"); return; }
      
      let enteredCode = document.getElementById("roomCodeInput").value.trim().toUpperCase();

      if (enteredCode) await joinRoom(enteredCode);
      else await createRoom();
    };

    async function createRoom() {
        roomCode = Math.random().toString(36).substring(2, 8).toUpperCase();
        const maxPlayers = parseInt(document.getElementById("playerCountInput").value);
        const roomData = {
            hostId: myPlayerId,
            maxPlayers: maxPlayers,
            status: "waiting",
            players: { [myPlayerId]: { name: playerName, score: 0 } }
        };
        await db.ref(`rooms/${roomCode}`).set(roomData);
        setupPresenceAndListen();
    }

    async function joinRoom(code) {
        const roomRef = db.ref(`rooms/${code}`);
        const roomSnap = await roomRef.get();
        if (!roomSnap.exists()) { alert("Oda bulunamadı."); return; }
        
        const roomData = roomSnap.val();
        if (Object.keys(roomData.players || {}).length >= roomData.maxPlayers) {
            alert("Oda dolu."); return;
        }
        if (roomData.status !== 'waiting') {
            alert("Oyun zaten başlamış."); return;
        }
        
        roomCode = code;
        await db.ref(`rooms/${code}/players/${myPlayerId}`).set({ name: playerName, score: 0 });
        setupPresenceAndListen();
    }
    
    function setupPresenceAndListen() {
        document.getElementById("startScreen").style.display = "none";
        
        const playerRef = db.ref(`rooms/${roomCode}/players/${myPlayerId}`);
        playerRef.onDisconnect().remove(); // Oyundan düşünce kendini sil
        
        if (roomListener) db.ref(`rooms/${roomCode}`).off("value", roomListener);
        
        roomListener = db.ref(`rooms/${roomCode}`).on("value", (snapshot) => {
            if (!snapshot.exists()) {
                alert("Oda kapatıldı veya bağlantı koptu.");
                window.location.reload();
                return;
            }
            const data = snapshot.val();
            updateUI(data);
        });
    }

    function updateUI(data) {
        document.getElementById("lobbyScreen").style.display = "none";
        document.getElementById("gameArea").style.display = "none";
        document.getElementById("endGameScreen").style.display = "none";
        document.getElementById("timer").style.display = "none";

        if (data.status === "waiting") {
            document.getElementById("lobbyScreen").style.display = "block";
            updateLobby(data);
        } else if (data.status === "playing") {
            document.getElementById("gameArea").style.display = "block";
            document.getElementById("timer").style.display = "block";
            updateGameArea(data);
        } else if (data.status === "finished") {
             document.getElementById("endGameScreen").style.display = "block";
             showEndGame(data);
        }
    }

    function updateLobby(data) {
        const lobbyDiv = document.getElementById("lobbyScreen");
        const players = data.players || {};
        const playerList = Object.values(players).map(p => `<li>${p.name}</li>`).join('');
        
        let lobbyHTML = `
            <h2>Oyun Lobisi</h2>
            <p>Bu kodu arkadaşlarınla paylaş: <strong>${roomCode}</strong></p>
            <h3>Oyuncular (${Object.keys(players).length}/${data.maxPlayers})</h3>
            <ul>${playerList}</ul>
        `;
        if (data.hostId === myPlayerId) {
            lobbyHTML += `<button id="btnForceStart">Oyunu Başlat</button>`;
        } else {
            lobbyHTML += `<p>Oda yöneticisinin oyunu başlatması bekleniyor...</p>`;
        }
        lobbyDiv.innerHTML = lobbyHTML;
        
        if (data.hostId === myPlayerId) {
            const startButton = document.getElementById("btnForceStart");
            if(Object.keys(players).length < 2) startButton.disabled = true; // En az 2 oyuncu olmalı
            startButton.onclick = () => startGame();
        }
    }
    
    async function startGame() {
        const roomData = (await db.ref(`rooms/${roomCode}`).get()).val();
        const playerIds = Object.keys(roomData.players);
        
        await db.ref(`rooms/${roomCode}`).update({
            status: 'playing',
            playerOrder: playerIds.sort(() => 0.5 - Math.random()),
            turnIndex: 0,
            turn: {
                playerId: playerIds[0],
                questions: generateStructuredTurnQuestions(),
                questionIndex: 0,
                revealedLetters: [],
                guess: "",
                startTime: firebase.database.ServerValue.TIMESTAMP
            }
        });
    }

    function updateGameArea(data) {
        const turn = data.turn;
        const players = data.players;
        const playerOrder = data.playerOrder;
        const turnIndex = data.turnIndex;
        const activePlayerId = playerOrder[turnIndex];
        const activePlayer = players[activePlayerId];

        if (!activePlayer) { // Oyuncu düşmüşse
            if (myPlayerId === data.hostId) nextPlayerTurn();
            return;
        }

        const isMyTurn = activePlayerId === myPlayerId;
        const q = turn.questions[turn.questionIndex];
        
        if (!q) { // Sorular bittiyse
            if(isMyTurn) nextPlayerTurn();
            return;
        }

        let placeholder = q.word.split('').map((char, i) => (turn.revealedLetters || [])[i] ? char : '_').join('');
        
        const gameHTML = `
            <h3>Sıradaki Oyuncu: ${activePlayer.name}</h3>
            <p><b>Soru ${turn.questionIndex + 1}/${turn.questions.length} (${q.word.length} Harfli)</b></p>
            <p><i>${q.definition}</i></p>
            <div class="question-placeholder">${placeholder}</div>
            <input type="text" id="answerInput" placeholder="Tahminini yaz" autocomplete="off" ${!isMyTurn ? 'disabled' : ''}>
            <div class="spectator-guess">${!isMyTurn && turn.guess ? `<b>${activePlayer.name} yazıyor:</b> ${turn.guess}` : ''}</div>
            <button id="btnSubmitAnswer" ${!isMyTurn ? 'disabled' : ''}>Gönder</button>
            <button id="btnRevealLetter" ${!isMyTurn ? 'disabled' : ''}>Harf Al (-100 Puan)</button>
            <hr>
            <h3>Skor Tablosu</h3>
            <ul>${playerOrder.map(pid => `<li class="${pid === activePlayerId ? 'active-player' : ''}"><span>${players[pid].name}</span> <span>${players[pid].score} Puan</span></li>`).join('')}</ul>
        `;
        document.getElementById("gameArea").innerHTML = gameHTML;

        const answerInput = document.getElementById("answerInput");
        if(isMyTurn) {
            answerInput.focus();
            answerInput.oninput = e => db.ref(`rooms/${roomCode}/turn/guess`).set(e.target.value);
            document.getElementById("btnSubmitAnswer").onclick = () => submitAnswer(q.word);
            document.getElementById("btnRevealLetter").onclick = () => revealLetter(q.word);
        } else {
            answerInput.value = turn.guess || "";
        }
        
        startTimer(turn.startTime);
    }
    
    async function submitAnswer(correctWord) {
        const guess = document.getElementById("answerInput").value.trim().toUpperCase();
        if (!guess) return;

        let scoreChange = 0;
        if (guess === correctWord.toUpperCase()) {
            scoreChange = points[correctWord.length] || 0;
        } else {
            scoreChange = -200; // Yanlış cevap cezası
        }
        await db.ref(`rooms/${roomCode}/players/${myPlayerId}/score`).set(firebase.database.ServerValue.increment(scoreChange));
        
        // Sıradaki soruya geç
        await db.ref(`rooms/${roomCode}/turn`).update({
            questionIndex: firebase.database.ServerValue.increment(1),
            revealedLetters: [],
            guess: ""
        });
    }

    // TAMAMLANMIŞ: Harf açma fonksiyonu
    async function revealLetter(word) {
        const turnRef = db.ref(`rooms/${roomCode}/turn`);
        const turnSnap = await turnRef.get();
        const turnData = turnSnap.val();
        
        let revealed = turnData.revealedLetters || [];
        const unrevealedIndexes = [];
        for(let i = 0; i < word.length; i++) {
            if(!revealed[i]) unrevealedIndexes.push(i);
        }

        if(unrevealedIndexes.length > 0) {
            const randomIndex = unrevealedIndexes[Math.floor(Math.random() * unrevealedIndexes.length)];
            revealed[randomIndex] = true;
            
            await db.ref(`rooms/${roomCode}/players/${myPlayerId}/score`).set(firebase.database.ServerValue.increment(-100));
            await turnRef.update({ revealedLetters: revealed });
        }
    }
    
    async function nextPlayerTurn() {
        stopTimer();
        const roomSnap = await db.ref(`rooms/${roomCode}`).get();
        const data = roomSnap.val();
        
        const newTurnIndex = data.turnIndex + 1;

        if (newTurnIndex >= data.playerOrder.length) {
            await db.ref(`rooms/${roomCode}`).update({ status: 'finished' });
        } else {
            const nextPlayerId = data.playerOrder[newTurnIndex];
            await db.ref(`rooms/${roomCode}`).update({
                turnIndex: newTurnIndex,
                turn: {
                    playerId: nextPlayerId,
                    questions: generateStructuredTurnQuestions(),
                    questionIndex: 0,
                    revealedLetters: [],
                    guess: "",
                    startTime: firebase.database.ServerValue.TIMESTAMP
                }
            });
        }
    }

    function showEndGame(data) {
        stopTimer();
        const players = Object.values(data.players).sort((a,b) => b.score - a.score);
        let html = `
            <h2>Oyun Bitti!</h2>
            <h3>Kazanan: ${players[0].name} 🏆</h3>
            <ul>
                ${players.map((p, i) => `<li><span>${i+1}. ${p.name}</span> <span>${p.score} Puan</span></li>`).join('')}
            </ul>
            <button onclick="window.location.reload()">Yeni Oyun</button>
        `;
        document.getElementById("endGameScreen").innerHTML = html;
        setTimeout(() => db.ref(`rooms/${roomCode}`).remove(), 30000); // 30 saniye sonra odayı sil
    }

    function startTimer(startTime) {
        stopTimer();
        timerInterval = setInterval(async () => {
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            let timeRemaining = TURN_DURATION - elapsed;
            
            if (timeRemaining <= 0) {
                timeRemaining = 0;
                stopTimer();
                const roomData = (await db.ref(`rooms/${roomCode}`).get()).val();
                if(myPlayerId === roomData.playerOrder[roomData.turnIndex]){
                    nextPlayerTurn();
                }
            }
            updateTimerDisplay(timeRemaining);
        }, 1000);
    }
    function stopTimer() { if (timerInterval) clearInterval(timerInterval); timerInterval = null; }
    function updateTimerDisplay(time) {
        if (time < 0) time = 0;
        const m = Math.floor(time / 60);
        const s = time % 60;
        document.getElementById("timer").textContent = `${m}:${s < 10 ? "0" + s : s}`;
    }
  </script>
</body>
</html>
```
